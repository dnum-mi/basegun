<script lang="ts" setup>
import { computed } from 'vue'
import { useRoute } from 'vue-router'

import type { DsfrHeader } from '@gouvminint/vue-dsfr'

const route = useRoute()

const wholeLogo = computed(() => route.meta.wholeLogo as boolean)

const isMobile = window.innerWidth <= 640

const logoText = computed<InstanceType<typeof DsfrHeader>['$props']['logoText']>(() => (!isMobile || wholeLogo.value)
  ? ['Ministère',
      'de l’intérieur',
      'et des Outre-Mer']
  : [])

const quickLinks: InstanceType<typeof DsfrHeader>['$props']['quickLinks'] = [
  {
    label: 'Important',
    to: '/',
  },
  {
    label: 'A propos',
    to: '/a-propos',
  },
  {
    label: 'Mentions légales',
    to: '/mentions-legales',
  },
  {
    label: 'Contact',
    to: '/contact',
  },
  {
    label: 'Accessibilité : partiellement conforme',
    to: '/accessibilite',
  },
]
</script>

<template>
  <DsfrHeader
    :class="{ 'marianne-only': !wholeLogo }"
    :quick-links="quickLinks"
    :show-beta="false"
    service-title=" "
    :home-to="{ name: 'StartPage' }"
    :logo-text="logoText"
  />
</template>

<style scoped>
:deep(.fr-container) {
  position: relative;
}

@screen lt-sm {
  .marianne-only :deep(.fr-logo::after) {
    display: none;
  }
}

:deep(.fr-header__navbar) {
  margin-top: 0 !important;
}

:deep(.fr-header__navbar .fr-btn--menu) {
  color : var(--text-action-high-blue-france);
  box-shadow: none;
}

.marianne-only :deep(.fr-header__logo .fr-logo::before) {
  background-size: cover;
  background-position: inherit;
  height: 1.2rem;
  margin-bottom: .25rem;
  width: 3rem;
}

:deep(.fr-header__service) {
  box-shadow: none;
  margin: 0;
  padding: 0;
  height: 0;
}

:deep(.fr-badge) {
  position: absolute;
  left: 4.25rem;
  bottom: 1rem;
}
</style>
